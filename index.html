<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Chères étoile - 无尽的爱来自灵魂</title><meta name="author" content="étoile"><meta name="copyright" content="étoile"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="人生海海 山山而川">
<meta property="og:type" content="website">
<meta property="og:title" content="Chères étoile">
<meta property="og:url" content="http://example.com/index.html">
<meta property="og:site_name" content="Chères étoile">
<meta property="og:description" content="人生海海 山山而川">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/img/head_img.jpg">
<meta property="article:author" content="étoile">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/img/head_img.jpg"><link rel="shortcut icon" href="/img/tag.png"><link rel="canonical" href="http://example.com/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=4.13.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.11.1/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Chères étoile',
  isPost: false,
  isHome: true,
  isHighlightShrink: false,
  isToc: false,
  postUpdate: '2025-07-02 14:41:33'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><link rel="stylesheet" href="/css/mycss.css"><link rel="stylesheet" href="/css/transpancy.css"><meta name="generator" content="Hexo 7.3.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/head_img.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">23</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">4</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">2</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="page" id="body-wrap"><header class="full_page" id="page-header" style="background-image: url('/img/cover_img.jpg')"><nav id="nav"><span id="blog-info"><a href="/" title="Chères étoile"><span class="site-name">Chères étoile</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="site-info"><h1 id="site-title">Chères étoile</h1><div id="site-subtitle"><span id="subtitle"></span></div></div><div id="scroll-down"><i class="fas fa-angle-down scroll-down-effects"></i></div></header><main class="layout" id="content-inner"><div class="recent-posts" id="recent-posts"><div class="recent-post-item"><div class="post_cover left"><a href="/2025/04/17/BUAA-OO-%E7%AC%AC%E4%BA%8C%E5%8D%95%E5%85%83%EF%BC%9A%E7%94%B5%E6%A2%AF%E8%B0%83%E5%BA%A6/" title="BUAA-OO-第二单元：电梯调度"><img class="post-bg" src="/img/OO_Unit2.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="BUAA-OO-第二单元：电梯调度"></a></div><div class="recent-post-info"><a class="article-title" href="/2025/04/17/BUAA-OO-%E7%AC%AC%E4%BA%8C%E5%8D%95%E5%85%83%EF%BC%9A%E7%94%B5%E6%A2%AF%E8%B0%83%E5%BA%A6/" title="BUAA-OO-第二单元：电梯调度">BUAA-OO-第二单元：电梯调度</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2025-04-17T07:13:35.000Z" title="发表于 2025-04-17 15:13:35">2025-04-17</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/BUAA/">BUAA</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/">面向对象</a></span></div><div class="content">[BUAA-OO] 第二单元：电梯调度[toc]
概述​    面向对象第二单元的主题是电梯调度，主要学习的内容是多线程调度与线程安全。具体体现为维护六个电梯线程以及主线程，调度线程的协同工作。第二单元共有三次作业，分别是：

乘客指定电梯的接送实现
自定义分配方式和实现临时调度（SCHE）
实现双轿厢（UPDATE）

​    与第一单元相比，第二单元的码量有所下降，在实现的时候也相较来说更容易上手一些。但是第二单元的难点在于调试和debug，具体来说：多线程下，程序错误可能难以复现。可能存在潜在的轮询，特定情况下死锁等不易察觉和修改的问题。一句话说就是这单元debug会特别痛苦。另一个难点就是电梯的调度策略，实现一个调度策略比较简单，但是实现一个性能特别好的调度策略很难。 
​    下面我们具体来回顾一下第二单元的作业。
UML 类图与协作图


 


第一次作业分析​    第一次作业的难点在于实现一个电梯调度算法。
​    电梯调度算法指的是单电梯如何高效地完成已分配给他的所有请求。总所周知，电梯调度算法本身没有最优解，一个算法可能在某种情况下效率比较高，但总会出现一种 ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2025/04/14/BUAA-OS-Lab2/" title="BUAA-OS-Lab2"><img class="post-bg" src="/img/OS_2.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="BUAA-OS-Lab2"></a></div><div class="recent-post-info"><a class="article-title" href="/2025/04/14/BUAA-OS-Lab2/" title="BUAA-OS-Lab2">BUAA-OS-Lab2</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2025-04-14T03:59:57.000Z" title="发表于 2025-04-14 11:59:57">2025-04-14</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/BUAA/">BUAA</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/">操作系统</a></span></div><div class="content">Lab2：内存管理[toc]
访存流程概览内核态内核态是操作系统运行的一种状态，与用户态相对，在这种状态下，计算机系统赋予了操作系统内核最高的权限。包括但不限于：

拥有最高权限：CPU可执行指令集中的所有指令，包括特权指令，进而直接访问和控制关键资源和硬件。
访问所有内存空间。
处理中断和异常。
系统资源管理：如CPU时间片分配，进程的创建与销毁等。

内存布局在我们设计的MOS操作系统中，内存的布局以及虚实映射关系如下：

虚拟地址：0x00000000 ~ 0x7fffffff（kuseg），这2GB空间用于存放用户程序代码与数据。需要通过TLB转化为物理地址，再通过cache访存。
虚拟地址：0x80000000 ~ 0x9fffffff（kseg0），这512MB空间用于存放内核代码与数据。将虚拟地址的最高位置零得到物理地址，通过cache访存。
虚拟地址：0xa0000000 ~ 0xbfffffff（kseg1），这512MB空间可以用于访问外存，将虚拟地址的最高三位置零得到物理地址，不通过cache访存
虚拟地址：0xc0000000 ~ 0xffffffff（kseg ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2025/03/28/BUAA-OS-Lab1/" title="BUAA-OS-Lab1"><img class="post-bg" src="/img/OS_1.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="BUAA-OS-Lab1"></a></div><div class="recent-post-info"><a class="article-title" href="/2025/03/28/BUAA-OS-Lab1/" title="BUAA-OS-Lab1">BUAA-OS-Lab1</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2025-03-28T08:51:31.000Z" title="发表于 2025-03-28 16:51:31">2025-03-28</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/BUAA/">BUAA</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/">操作系统</a></span></div><div class="content">Lab1：操作系统的内核，启动[toc]
ELF——操作系统内核的本质
链接器通过哪些信息来链接多个目标文件呢？
在目标文件中，记录了代码各个段的具体信息。链接器通过这些信息来将目标文件链接到一起。

ELF是一种用于可重定位文件（如目标文件），可执行文件和共享对象文件的文件格式

可执行文件：包含完整程序（所有跳转地址都已确认，可被操作系统直接加载到内存运行），有明确的入口地址。具有程序头表，操作系统据此将文件映射到内存。
可重定位文件：包含一些尚未确定具体地址的符号，需要在链接过程中重定位。
共享对象文件：代码和数据可被多个程序同时使用，从而减少内存使用。：共享对象文件在程序运行时才会被加载到内存中，而不是在链接时静态地合并到可执行文件中，这样可以省去重复编译。




elf.h是一个头文件，在类Unix系统里，它定义了ELF文件格式的各种数据结构与常量。借助elf.h我们能够编写程序来读取，解析，操作ELF文件。
12345678910111213141516typedef struct &#123;        unsigned char e_ident[EI_NIDENT ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2025/03/19/BUAA-OO-%E7%AC%AC%E4%B8%80%E5%8D%95%E5%85%83%EF%BC%9A%E8%A1%A8%E8%BE%BE%E5%BC%8F%E5%8C%96%E7%AE%80/" title="[BUAA-OO]第一单元：表达式化简"><img class="post-bg" src="/img/OO_Unit1.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="[BUAA-OO]第一单元：表达式化简"></a></div><div class="recent-post-info"><a class="article-title" href="/2025/03/19/BUAA-OO-%E7%AC%AC%E4%B8%80%E5%8D%95%E5%85%83%EF%BC%9A%E8%A1%A8%E8%BE%BE%E5%BC%8F%E5%8C%96%E7%AE%80/" title="[BUAA-OO]第一单元：表达式化简">[BUAA-OO]第一单元：表达式化简</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2025-03-19T00:27:51.000Z" title="发表于 2025-03-19 08:27:51">2025-03-19</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/BUAA/">BUAA</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/">面向对象</a></span></div><div class="content">[BUAA-OO] 第一单元：表达式展开[toc]
概述​    面向对象课第一单元的主题是表达式展开和化简，主要考察的内容是面向对象设计的思想，具体体现为表达式(Expr)，项(Term)等类的构建和它们的对象，方法的管理。第一单元共有三次迭代任务，分别是：

单变量单层括号的多项式展开 
含有自定义递推函数，三角函数，多层括号的多项式展开和化简
含有自定义普通函数的多项式展开，求导和化简

​    客观来说，第一次作业由于是从零开始构建，难点主要在于理解递归下降的到底要做什么，以及怎么实现递归下降解析。第二次作业的难度和码量同步达到了巅峰，三角函数的引入改变了多项式最基本组成单元的形式，递推函数的引入大大增加了解析和计算的难度，多层括号可能意味着递归层数的加深。第三次作业的难点主要在于求导的设计。下面我们具体来回顾和总结第一单元的开发。
UML类图和度量分析​    第一单元作业的类图如下：


​    在本次作业中，我总共创建了17个类或接口的实现，共1600余行代码。在此具体解释一下每个类的设计考虑：
123456789101112131415161718192021222 ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2025/03/13/BUAA-OS-Lab0/" title="[BUAA-OS]Lab0"><img class="post-bg" src="/img/OS_0.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="[BUAA-OS]Lab0"></a></div><div class="recent-post-info"><a class="article-title" href="/2025/03/13/BUAA-OS-Lab0/" title="[BUAA-OS]Lab0">[BUAA-OS]Lab0</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2025-03-13T06:05:44.000Z" title="发表于 2025-03-13 14:05:44">2025-03-13</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/BUAA/">BUAA</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/">操作系统</a></span></div><div class="content">Hello Linux!
Hello Linux围绕Linux基础操作，Linux下的开发工具，Linux操作补充，Shell Script四个部分展开

[toc]
Linux基础操作
ls:
1234ls [选项] [文件]选项：-a		显示包括隐藏项目在内的所有项目-l		列出文件详细信息，每行一个文件

touch
1touch [选项] [文件名]		创建新文件或更新现有文件时间戳

mkdir 和 rmdir
12mkdir [选项] 目录名		创建新文件夹/目录rmdir [选项] 目录名		删除空文件夹/空目录

pwd
1pwd			查看当前绝对路径 一般从/home开始显示

cd
1cd [选项] 目录名			跳转到指定目录

rm
12345rm [选项] 文件名选项：-r		递归删除目录及其内容，删除一个非空目录必须加-r-f		强制删除不提示确认-i		交互式（即总是会询问用户是否确定删除）
使用 rm 命令要格外小心，因为一旦删除了一个文件，就无法再恢复它。一些用户 会在家目录下建一个类似回收站的目录，如果要使用rm命令，先把要删除的文件 移到这个目录里， ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2025/03/03/BUAA-OO-%E7%AC%AC%E4%B8%80%E5%8D%95%E5%85%83%E7%AC%AC1%E6%AC%A1%E4%BD%9C%E4%B8%9A/" title="[BUAA-OO]第一单元第1次作业"><img class="post-bg" src="/img/OO_hw1.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="[BUAA-OO]第一单元第1次作业"></a></div><div class="recent-post-info"><a class="article-title" href="/2025/03/03/BUAA-OO-%E7%AC%AC%E4%B8%80%E5%8D%95%E5%85%83%E7%AC%AC1%E6%AC%A1%E4%BD%9C%E4%B8%9A/" title="[BUAA-OO]第一单元第1次作业">[BUAA-OO]第一单元第1次作业</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2025-03-03T07:20:46.000Z" title="发表于 2025-03-03 15:20:46">2025-03-03</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/BUAA/">BUAA</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/">面向对象</a></span></div><div class="content">BUAA-OO 第一单元第一次作业[toc]

第一次作业主要是关于单变量多项式的展开，这次我们需要展开的表达式中项只有三种——幂函数，常数因子和表达式因子。我们的输出不能有括号，并且还要尽可能的简单。

思路概述
我们首先通过标准输入获得一个符合规范的表达式，并将其以String的类型传入lexer进行词法解析，获得一系列词块（token）。
然后我们利用递归下降的方法将token组合起来，自底向上形成一个个符合规范的factor，term，expression。
通过建立多项式类（Poly），单项式类（Mono）和实现它们的加，减，乘，幂运算方法来展开表达式。
最后还需要对输出结果做一定的化简。

代码UML类图

词法解析​    词法解析中用到的lexer类沿用了OOpre_hw7中的设计思路，它具有如下属性：
1234public class Lexer &#123;    private ArrayList&lt;Token&gt; tokens = new ArrayList&lt;&gt;();    private int index = 0;&#125;
​     ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2024/12/16/BUAA-CO-P6%E4%B9%A0%E9%A2%98%E5%88%86%E6%9E%90/" title="BUAA_CO_P6习题分析"><img class="post-bg" src="/img/CO_P6_S.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="BUAA_CO_P6习题分析"></a></div><div class="recent-post-info"><a class="article-title" href="/2024/12/16/BUAA-CO-P6%E4%B9%A0%E9%A2%98%E5%88%86%E6%9E%90/" title="BUAA_CO_P6习题分析">BUAA_CO_P6习题分析</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2024-12-16T09:35:23.000Z" title="发表于 2024-12-16 17:35:23">2024-12-16</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/BUAA/">BUAA</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90/">计算机组成</a></span></div><div class="content">P6 习题分析
wtd指令：
记temp1为GRF[rs]的32种循环移位的和 如： 123 + 231 + 321
temp2为GRF[rt]的32种循环移位的和 
if (temp1 &gt; temp2) 则 把1写入rd 
else if  (temp1 &lt; temp2) 则 把 -1写入rd
else 把0写入rd

12345678910111213141516171819202122232425262728293031323334353637383940/* 整体分析：在D级实现一个组合逻辑计算出temp1和temp2，进而确定回写内容 */controllerwire wtd = (opcode_DEin == 6&#x27;b0 &amp;&amp; func_DEin == 6&#x27;b000011) ? 1 : 0;/* 生成控制信号 */RegWrite_DEin = (wtd || ...) ? 1 : 0;RegDst_DEin = (wtd || ...) ? 2&#x27;b01 : ...  // 写入rd寄存器/* 生成特判信号 */wir ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2024/12/15/BUAA-CO-P7/" title="BUAA_CO_P7"><img class="post-bg" src="/img/CO_P7.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="BUAA_CO_P7"></a></div><div class="recent-post-info"><a class="article-title" href="/2024/12/15/BUAA-CO-P7/" title="BUAA_CO_P7">BUAA_CO_P7</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2024-12-15T11:29:34.000Z" title="发表于 2024-12-15 19:29:34">2024-12-15</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/BUAA/">BUAA</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90/">计算机组成</a></span></div><div class="content">MIPS微系统
 P7需要我们的CPU支持异常处理。
 具体地说，就是在“异常事件”发生的时候，调用一段预先写好的程序来处理这种异常，处理结束后再跳转回原来的程序。
 P7新增了4条与系统相关的指令：mfc0 mtc0 eret syscall

概念异常事件我们提到的“异常事件”有两种：异常和中断

（内部）异常：
加法溢出
除法除零


（外部）中断：
计时器信号
键盘输入



系统桥系统桥是连接CPU和外设的功能设备，它会给 CPU 提供一种接口，使得 CPU 可以像读写普通存储器一样（即按地址读写）来读写复杂多变的外设。
系统桥统一且简化了 CPU 的对外接口，CPU 不必为每种外设单独提供接口，符合高内聚，低耦合的设计思想。
将CPU封装成单周期对于CPU的外部来说，它并不关心流水线中有多少条指令，是否阻塞等问题。
他们可以简单的认为CPU就是每次处理一条指令的“单周期”的。这是理解流水线CPU封装的关键所在。
CP0协处理器
CP0的两个功能：读写内部寄存器（mfc0 mtc0）+ 判断是否进行异常跳转


读写内部寄存器
有哪些寄存器？
| 寄存器  | 位数 | 编号 ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2024/12/07/BUAA-CO-P6/" title="BUAA_CO_P6"><img class="post-bg" src="/img/CO_P6.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="BUAA_CO_P6"></a></div><div class="recent-post-info"><a class="article-title" href="/2024/12/07/BUAA-CO-P6/" title="BUAA_CO_P6">BUAA_CO_P6</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2024-12-07T13:38:19.000Z" title="发表于 2024-12-07 21:38:19">2024-12-07</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/BUAA/">BUAA</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90/">计算机组成</a></span></div><div class="content">P6支持30指令的五级全速流水线指令分析29条指令

计算类指令：add sub and or slt sltu lui addi andi ori nop
访存类指令：lb lh lw sb sh sw
乘除类指令：mult multu div divu mfhi mflo mthi mtlo 
分支类指令：beq bne
跳转类指令： jal jr

数据冒险需要回写的有16条指令：add sub and or slt sltu lui addi andi ori lb lh lw mfhi mflo jal
转发阻塞Tuse : 在D级用数据为0，E级为1，M级为2，用不到数据为max（在编写时，max = 3）





add
sub
and
or
slt
sltu
lui
addi
andi
ori
nop




Tuse_RS
1
1
1
1
1
1
max
1
1
1
max


Tuse_RT
1
1
1
1
1
1
max
max
max
max
max









lb
lh
lw
sb
sh
sw
beq
bne
jal
jr




Tuse_RS
1 ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2024/11/25/BUAA-CO-P5%E4%B9%A0%E9%A2%98%E5%88%86%E6%9E%90/" title="BUAA_CO_P5习题分析"><img class="post-bg" src="/img/CO_P5_special.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="BUAA_CO_P5习题分析"></a></div><div class="recent-post-info"><a class="article-title" href="/2024/11/25/BUAA-CO-P5%E4%B9%A0%E9%A2%98%E5%88%86%E6%9E%90/" title="BUAA_CO_P5习题分析">BUAA_CO_P5习题分析</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2024-11-25T09:16:21.000Z" title="发表于 2024-11-25 17:16:21">2024-11-25</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/BUAA/">BUAA</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90/">计算机组成</a></span></div><div class="content">增添指令注意事项：

注意必须在每一级的WriteBack和RegAddr检查回写的内容和地址是否符合新增指令的期望，防止在上游产生的正确回写数据在下游被覆盖！
注意务必为新增指令添加阻塞板块Tuse Tnew的取值。
由于特判信号是随着指令在流水线中流动的，所以其后也要加_DEin这样的后缀。
注意默认拓展是0拓展，要进行符号拓展需要将新增指令的特判信号传入EXTOp。

运算类(1) 运算 + 判断 + 回写（地址确定）

P4T1添加指令为 eam，R型指令。具体操作为，取出 GPR[rs] 的低16位，作为一个有符号数对17取模，结果必须为0~16的某一个非负数，结果为一个16位的数。之后，若 GPR[rt] 的最高位为1，则将该运算结果零扩展至32位，否则将该运算结果一扩展至32位。将结果存至 GPR[rd] 中。

1234567891011121314151617181920212223242526272829/* 整体分析：该题对GRF[rs]取值计算，根据GRF[rt]的最高位决定回写内容，存于固定地址根据尽早产生数据的原则，我们希望利用D级内的组合逻辑得到正确的要回 ...</div></div></div><nav id="pagination"><div class="pagination"><span class="page-number current">1</span><a class="page-number" href="/page/2/#content-inner">2</a><a class="page-number" href="/page/3/#content-inner">3</a><a class="extend next" rel="next" href="/page/2/#content-inner"><i class="fas fa-chevron-right fa-fw"></i></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/head_img.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">étoile</div><div class="author-info__description">人生海海 山山而川</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">23</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">4</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">2</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">Hellooo, welcome to étoile's Blog !</div></div><div class="sticky_layout"><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2025/04/17/BUAA-OO-%E7%AC%AC%E4%BA%8C%E5%8D%95%E5%85%83%EF%BC%9A%E7%94%B5%E6%A2%AF%E8%B0%83%E5%BA%A6/" title="BUAA-OO-第二单元：电梯调度"><img src="/img/OO_Unit2.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="BUAA-OO-第二单元：电梯调度"/></a><div class="content"><a class="title" href="/2025/04/17/BUAA-OO-%E7%AC%AC%E4%BA%8C%E5%8D%95%E5%85%83%EF%BC%9A%E7%94%B5%E6%A2%AF%E8%B0%83%E5%BA%A6/" title="BUAA-OO-第二单元：电梯调度">BUAA-OO-第二单元：电梯调度</a><time datetime="2025-04-17T07:13:35.000Z" title="发表于 2025-04-17 15:13:35">2025-04-17</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/04/14/BUAA-OS-Lab2/" title="BUAA-OS-Lab2"><img src="/img/OS_2.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="BUAA-OS-Lab2"/></a><div class="content"><a class="title" href="/2025/04/14/BUAA-OS-Lab2/" title="BUAA-OS-Lab2">BUAA-OS-Lab2</a><time datetime="2025-04-14T03:59:57.000Z" title="发表于 2025-04-14 11:59:57">2025-04-14</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/03/28/BUAA-OS-Lab1/" title="BUAA-OS-Lab1"><img src="/img/OS_1.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="BUAA-OS-Lab1"/></a><div class="content"><a class="title" href="/2025/03/28/BUAA-OS-Lab1/" title="BUAA-OS-Lab1">BUAA-OS-Lab1</a><time datetime="2025-03-28T08:51:31.000Z" title="发表于 2025-03-28 16:51:31">2025-03-28</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/03/19/BUAA-OO-%E7%AC%AC%E4%B8%80%E5%8D%95%E5%85%83%EF%BC%9A%E8%A1%A8%E8%BE%BE%E5%BC%8F%E5%8C%96%E7%AE%80/" title="[BUAA-OO]第一单元：表达式化简"><img src="/img/OO_Unit1.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="[BUAA-OO]第一单元：表达式化简"/></a><div class="content"><a class="title" href="/2025/03/19/BUAA-OO-%E7%AC%AC%E4%B8%80%E5%8D%95%E5%85%83%EF%BC%9A%E8%A1%A8%E8%BE%BE%E5%BC%8F%E5%8C%96%E7%AE%80/" title="[BUAA-OO]第一单元：表达式化简">[BUAA-OO]第一单元：表达式化简</a><time datetime="2025-03-19T00:27:51.000Z" title="发表于 2025-03-19 08:27:51">2025-03-19</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/03/13/BUAA-OS-Lab0/" title="[BUAA-OS]Lab0"><img src="/img/OS_0.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="[BUAA-OS]Lab0"/></a><div class="content"><a class="title" href="/2025/03/13/BUAA-OS-Lab0/" title="[BUAA-OS]Lab0">[BUAA-OS]Lab0</a><time datetime="2025-03-13T06:05:44.000Z" title="发表于 2025-03-13 14:05:44">2025-03-13</time></div></div></div></div><div class="card-widget card-categories"><div class="item-headline">
            <i class="fas fa-folder-open"></i>
            <span>分类</span>
            
            </div>
            <ul class="card-category-list" id="aside-cat-list">
            <li class="card-category-list-item "><a class="card-category-list-link" href="/categories/BUAA/"><span class="card-category-list-name">BUAA</span><span class="card-category-list-count">21</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Exploration/"><span class="card-category-list-name">Exploration</span><span class="card-category-list-count">1</span></a></li>
            </ul></div><div class="card-widget card-tags"><div class="item-headline"><i class="fas fa-tags"></i><span>标签</span></div><div class="card-tag-cloud"><a href="/tags/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/" style="font-size: 1.37em; color: #99a4b2">面向对象</a> <a href="/tags/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/" style="font-size: 1.23em; color: #999ea6">操作系统</a> <a href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90/" style="font-size: 1.5em; color: #99a9bf">计算机组成</a> <a href="/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/" style="font-size: 1.1em; color: #999">机器学习</a></div></div><div class="card-widget card-archives"><div class="item-headline"><i class="fas fa-archive"></i><span>归档</span></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/04/"><span class="card-archive-list-date">四月 2025</span><span class="card-archive-list-count">2</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/03/"><span class="card-archive-list-date">三月 2025</span><span class="card-archive-list-count">4</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/12/"><span class="card-archive-list-date">十二月 2024</span><span class="card-archive-list-count">3</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/11/"><span class="card-archive-list-date">十一月 2024</span><span class="card-archive-list-count">2</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/10/"><span class="card-archive-list-date">十月 2024</span><span class="card-archive-list-count">6</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/09/"><span class="card-archive-list-date">九月 2024</span><span class="card-archive-list-count">5</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/08/"><span class="card-archive-list-date">八月 2024</span><span class="card-archive-list-count">1</span></a></li></ul></div><div class="card-widget card-webinfo"><div class="item-headline"><i class="fas fa-chart-line"></i><span>网站资讯</span></div><div class="webinfo"><div class="webinfo-item"><div class="item-name">文章数目 :</div><div class="item-count">23</div></div><div class="webinfo-item"><div class="item-name">已运行时间 :</div><div class="item-count" id="runtimeshow" data-publishDate="2024-08-25T13:57:00.000Z"><i class="fa-solid fa-spinner fa-spin"></i></div></div><div class="webinfo-item"><div class="item-name">本站访客数 :</div><div class="item-count" id="busuanzi_value_site_uv"><i class="fa-solid fa-spinner fa-spin"></i></div></div><div class="webinfo-item"><div class="item-name">本站总访问量 :</div><div class="item-count" id="busuanzi_value_site_pv"><i class="fa-solid fa-spinner fa-spin"></i></div></div><div class="webinfo-item"><div class="item-name">最后更新时间 :</div><div class="item-count" id="last-push-date" data-lastPushDate="2025-07-02T06:41:33.655Z"><i class="fa-solid fa-spinner fa-spin"></i></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2025 By étoile</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=4.13.0"></script><script src="/js/main.js?v=4.13.0"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"><script>window.typedJSFn = {
  init: (str) => {
    window.typed = new Typed('#subtitle', Object.assign({
      strings: str,
      startDelay: 300,
      typeSpeed: 150,
      loop: true,
      backSpeed: 50,
    }, null))
  },
  run: (subtitleType) => {
    if (true) {
      if (typeof Typed === 'function') {
        subtitleType()
      } else {
        getScript('https://cdn.jsdelivr.net/npm/typed.js@2.1.0/dist/typed.umd.min.js').then(subtitleType)
      }
    } else {
      subtitleType()
    }
  }
}
</script><script>function subtitleType () {
  if (true) {
    typedJSFn.init(["种好的鲜花 治愈你的白发","从前从前 有个人爱你很久","梦里回到她的身旁 蜜语中风不再凉","那跑过去的昼夜 是孤独的修炼","忘掉种过的花 重新的出发"])
  } else {
    document.getElementById("subtitle").textContent = "种好的鲜花 治愈你的白发"
  }
}
typedJSFn.run(subtitleType)</script></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer@1.10.1/dist/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/aplayer@1.10.1/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/metingjs/dist/Meting.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>